"use strict";(self.webpackChunkuwb_client_app=self.webpackChunkuwb_client_app||[]).push([[632],{7378:(I,v,i)=>{i.d(v,{L:()=>D});var e=i(9291),_=i(9185),A=i(4089),d=i(6814),t=i(3999);function T(m,y){if(1&m){const n=e.EpF();e.TgZ(0,"p-button",2),e.NdJ("onClick",function(){e.CHM(n);const C=e.oxw();return e.KtG(C.onAddClick())}),e.ALo(1,"translate"),e.qZA()}if(2&m){const n=e.oxw();e.Tol(n.styleClass),e.Q6J("disabled",n.disabledAddButton)("icon",n.mobileScreen?"pi pi-plus":"")("label",n.mobileScreen?"":e.lcZ(1,6,"global.buttons.add"))("styleClass",n.mobileScreen?n.mobileScreenStyleButtons:n.smallScreen?n.smallScreenStyleButtons:n.normalScreenStyleButtons)}}function p(m,y){if(1&m){const n=e.EpF();e.TgZ(0,"p-button",2),e.NdJ("onClick",function(){e.CHM(n);const C=e.oxw();return e.KtG(C.onEditClick())}),e.ALo(1,"translate"),e.qZA()}if(2&m){const n=e.oxw();e.Tol(n.styleClass),e.Q6J("disabled",n.disabledEditAndDeleteButton)("icon",n.mobileScreen?"pi pi-pencil":"")("label",n.mobileScreen?"":e.lcZ(1,6,"global.buttons.edit"))("styleClass",n.mobileScreen?n.mobileScreenStyleButtons:n.smallScreen?n.smallScreenStyleButtons:n.normalScreenStyleButtons)}}function b(m,y){if(1&m){const n=e.EpF();e.TgZ(0,"p-button",2),e.NdJ("onClick",function(){e.CHM(n);const C=e.oxw();return e.KtG(C.onDeleteClick())}),e.ALo(1,"translate"),e.qZA()}if(2&m){const n=e.oxw();e.Tol(n.styleClass),e.Q6J("disabled",n.disabledEditAndDeleteButton)("icon",n.mobileScreen?"pi pi-trash":"")("label",n.mobileScreen?"":e.lcZ(1,6,"global.buttons.delete"))("styleClass",n.mobileScreen?n.mobileScreenStyleButtons:n.smallScreen?n.smallScreenStyleButtons:n.normalScreenStyleButtons)}}const O=["*"];let D=(()=>{class m{constructor(n){this.sizeScreenService=n,this.showAddButton=!0,this.showEditButton=!0,this.showDeleteButton=!0,this.disabledAddButton=!1,this.disabledEditAndDeleteButton=!1,this.normalScreenStyleButtons="ui-button_size_175",this.smallScreenStyleButtons="ui-button_size_125",this.mobileScreenStyleButtons="ui-button_size_100",this.styleClass="col-4 px-2",this.emitAddClick=new e.vpe,this.emitEditClick=new e.vpe,this.emitDeleteClick=new e.vpe,this.smallScreen=!1,this.mobileScreen=!1}ngOnInit(){this.sizeScreenService.smallScreen$.subscribe(n=>{this.smallScreen=n}),this.sizeScreenService.mobileScreen$.subscribe(n=>{this.mobileScreen=n})}onAddClick(){this.emitAddClick.emit(!0)}onEditClick(){this.emitEditClick.emit(!0)}onDeleteClick(){this.emitDeleteClick.emit(!0)}}return m.\u0275fac=function(n){return new(n||m)(e.Y36(_.p))},m.\u0275cmp=e.Xpm({type:m,selectors:[["uwb-footer-buttons"]],inputs:{showAddButton:"showAddButton",showEditButton:"showEditButton",showDeleteButton:"showDeleteButton",disabledAddButton:"disabledAddButton",disabledEditAndDeleteButton:"disabledEditAndDeleteButton",normalScreenStyleButtons:"normalScreenStyleButtons",smallScreenStyleButtons:"smallScreenStyleButtons",mobileScreenStyleButtons:"mobileScreenStyleButtons",styleClass:"styleClass"},outputs:{emitAddClick:"emitAddClick",emitEditClick:"emitEditClick",emitDeleteClick:"emitDeleteClick"},ngContentSelectors:O,decls:5,vars:3,consts:[[1,"grid"],[3,"class","disabled","icon","label","styleClass","onClick",4,"ngIf"],[3,"disabled","icon","label","styleClass","onClick"]],template:function(n,S){1&n&&(e.F$t(),e.TgZ(0,"div",0),e.YNc(1,T,2,8,"p-button",1),e.YNc(2,p,2,8,"p-button",1),e.YNc(3,b,2,8,"p-button",1),e.Hsn(4),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngIf",S.showAddButton),e.xp6(1),e.Q6J("ngIf",S.showEditButton),e.xp6(1),e.Q6J("ngIf",S.showDeleteButton))},dependencies:[A.zx,d.O5,t.X$]}),m})()},7397:(I,v,i)=>{i.d(v,{s:()=>C});var e=i(9291),_=i(6223),A=i(3562),d=i(2420),t=i(9972),T=i(737),p=i(6814);function b(r,f){if(1&r){const o=e.EpF();e.TgZ(0,"div",5)(1,"div",6)(2,"input",7),e.NdJ("ngModelChange",function(h){e.CHM(o);const u=e.oxw();return e.KtG(u.filterText=h)})("input",function(h){e.CHM(o);const u=e.oxw();return e.KtG(u.customFilter(h))}),e.qZA(),e._UZ(3,"i",8),e.qZA()()}if(2&r){const o=e.oxw();e.xp6(2),e.Q6J("ngModel",o.filterText)}}function O(r,f){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.hij(" ",null==o?null:o.data[s.optionLabel]," ")}}function D(r,f){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){const o=e.oxw(2);e.xp6(1),e.hij(" ",o.placeholder," ")}}function m(r,f){if(1&r&&(e.YNc(0,O,2,1,"span",9),e.YNc(1,D,2,1,"span",9)),2&r){const o=f.$implicit,s=e.oxw();e.Q6J("ngIf",null==o?null:o.data),e.xp6(1),e.Q6J("ngIf",!(null!=o&&o.data||s.floatLabel))}}function y(r,f){if(1&r&&(e.TgZ(0,"span",10),e._uU(1),e.ALo(2,"slice"),e.qZA()),2&r){const o=f.$implicit,s=e.oxw();e.s9C("pTooltip",o.data[s.optionLabel]),e.xp6(1),e.hij(" ",o.data[s.optionLabel].length>30?e.Dn7(2,2,o.data[s.optionLabel],0,30)+"...":o.data[s.optionLabel]," ")}}function n(r,f){if(1&r&&(e.TgZ(0,"label",11),e._uU(1),e.qZA()),2&r){const o=e.oxw();e.xp6(1),e.Oqu(o.label)}}const S=function(){return{width:"100%"}};let C=(()=>{class r{constructor(){this.options=[],this.filter=!0,this.label="Wybierz opcje",this.optionLabel="name",this.styleClass="",this.selectionMode="single",this.floatLabel=!0,this.placeholder="",this.modelChange=new e.vpe,this.itemChange=new e.vpe,this.onModelChange=()=>d.Z,this.onModelTouched=()=>d.Z,this.handleOptions=[],this.filterText=""}ngOnChanges(o){o.options&&(this.handleOptions=this.options)}ngAfterViewInit(){this.treeSelect.registerOnChange(this.onModelChange),this.treeSelect.registerOnTouched(this.onModelTouched)}customFilter(o){const s=this.filterText.toLowerCase();""===s?this.options=this.handleOptions:(this.options=this.handleOptions,this.options=this.filterTree(this.options,s))}filterTree(o,s){const h=[];for(const u of o)if(u?.data&&u.data.name.toLowerCase().includes(s)&&!h.find(E=>E.data.id===u.data.id)&&h.push(u),u.children&&u.children.length>0){const E=this.filterTree(u.children,s);if(E.length>0&&!h.find(B=>B.data.id===u.data.id)){const B={...u};B.children=E,h.push(B)}}return h}writeValue(o){this.treeSelectValue=o}registerOnChange(o){this.onModelChange=o}registerOnTouched(o){this.onModelTouched=o}emitModelAndItemChange(o){this.modelChange.emit(o.node.data),this.emitItemChange({value:o.node.data})}emitItemChange(o){const s=o.value?this.options.find(h=>h?.[this.itemValue]===o.value):void 0;this.itemChange.emit(Object.assign({},o,{item:s??null}))}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["uwb-tree-select"]],viewQuery:function(o,s){if(1&o&&e.Gf(A.mP,7),2&o){let h;e.iGM(h=e.CRH())&&(s.treeSelect=h.first)}},inputs:{options:"options",filter:"filter",label:"label",optionLabel:"optionLabel",treeSelectValue:"treeSelectValue",itemValue:"itemValue",styleClass:"styleClass",selectionMode:"selectionMode",floatLabel:"floatLabel",placeholder:"placeholder"},outputs:{modelChange:"modelChange",itemChange:"itemChange"},features:[e._Bn([{provide:_.JU,useExisting:(0,e.Gpc)(()=>r),multi:!0}]),e.TTD],decls:6,vars:12,consts:[["placeholder","","appendTo","body",3,"ngModel","options","placeholder","selectionMode","ngModelChange","onNodeSelect"],["pTemplate","header"],["pTemplate","value"],["pTemplate","default"],["for","label",4,"ngIf"],[1,"p-treeselect-header"],[1,"p-treeselect-filter-container","p-input-icon-right","custom-filter"],["type","text","autofocus","","placeholder","Filter",1,"p-treeselect-filter","p-inputtext","p-component",3,"ngModel","ngModelChange","input"],[1,"pi","pi-search"],[4,"ngIf"],[3,"pTooltip"],["for","label"]],template:function(o,s){1&o&&(e.TgZ(0,"span")(1,"p-treeSelect",0),e.NdJ("ngModelChange",function(u){return s.treeSelectValue=u})("onNodeSelect",function(u){return s.emitModelAndItemChange(u)}),e.YNc(2,b,4,1,"ng-template",1),e.YNc(3,m,2,2,"ng-template",2),e.YNc(4,y,3,6,"ng-template",3),e.qZA(),e.YNc(5,n,2,1,"label",4),e.qZA()),2&o&&(e.Tol(s.floatLabel?"p-float-label":""),e.xp6(1),e.Akn(e.DdM(11,S)),e.Tol(s.styleClass),e.Q6J("ngModel",s.treeSelectValue)("options",s.options)("placeholder",s.placeholder)("selectionMode",s.selectionMode),e.xp6(4),e.Q6J("ngIf",s.floatLabel))},dependencies:[t.jx,T.u,A.mP,_.Fj,_.JJ,_.On,p.O5,p.OU],styles:[".p-inputtext.ng-valid[_ngcontent-%COMP%]{border-left:none;border:1px solid #ced4da}  .p-treeselect .p-treeselect-label span{color:#000}  .p-treeselect-items-wrapper::-webkit-scrollbar{width:12px}  .p-treeselect-items-wrapper::-webkit-scrollbar-thumb{border-radius:.5rem;background:var(--uwb-menu-scrollbar-thumb)}  .p-treeselect-items-wrapper::-webkit-scrollbar-thumb:hover{background:var(--uwb-menu-scrollbar-thumb-hover)}  .p-treeselect-items-wrapper::-webkit-scrollbar-track{background:var(--uwb-menu-scrollbar-track);background-color:transparent}"]}),r})()},1632:(I,v,i)=>{i.r(v),i.d(v,{AreaTypesModule:()=>F});var e=i(6106),_=i(6208),A=i(2125),d=i(6223),t=i(9291),T=i(8193),p=i(1321),b=i(5470),O=i(7966),D=i(3999),m=i(5969),y=i(7477),n=i(2435),S=i(7571),C=i(7397),r=i(6861),f=i(6814);function o(c,w){1&c&&t._UZ(0,"uwb-input-warn",10),2&c&&t.Q6J("minLength",2)("maxLength",50)}let s=(()=>{class c{constructor(l,a,g,U,M,x,L){this.formBuilder=l,this.ref=a,this.config=g,this.clientsService=U,this.areaTypesService=M,this.toastService=x,this.translateService=L,this.edit=!1,this.dropdownObjectTypeItems=[],this.treeSelectItems=[]}ngOnInit(){this.loadPageData(),this.loadFormGroup(),this.loadOrganizationUnits()}loadPageData(){this.edit=this.config.data.edit,this.selectedAreaType=this.config.data.selectedAreaType,this.pageSelectedOrganizationUnit=this.config.data.selectedOrganizationUnit}loadFormGroup(){this.formGroup=this.formBuilder.group({name:[{value:null,disabled:!1},[d.kI.required,d.kI.minLength(2),d.kI.maxLength(50)]],color:[{value:null,disabled:!1},[d.kI.required]],organizationUnitId:[{value:null,disabled:!1},[d.kI.required]]}),this.edit&&this.formGroup.patchValue({name:this.selectedAreaType?.name,color:this.selectedAreaType?.color,organizationUnitId:null})}loadOrganizationUnits(){this.clientsService.findTree().subscribe(l=>{if(this.treeSelectItems=l.body??[],this.edit){const a=this.clientsService.findByIdFromUnits(this.treeSelectItems[0],this.selectedAreaType?.organizationUnitId);this.formGroup?.get("organizationUnitId")?.setValue(a)}else{const a=this.clientsService.findByIdFromUnits(this.treeSelectItems[0],this.pageSelectedOrganizationUnit?.id);this.formGroup?.get("organizationUnitId")?.setValue(a)}})}onSave(){let l=this.formGroup?.getRawValue();l={...l,organizationUnitId:l.organizationUnitId.data.id},this.edit?(l.id=this.selectedAreaType?.id,this.areaTypesService.update(l).subscribe({next:()=>{this.toastService.showSuccessToast({summary:this.translateService.instant("global.toast.header.success"),detail:this.translateService.instant("areaType.dialog.editSuccess")}),this.onCloseDialog(!0)},error:()=>{this.toastService.showErrorToast({summary:this.translateService.instant("global.toast.header.error"),detail:this.translateService.instant("areaType.dialog.editError")})}})):this.areaTypesService.create(l).subscribe({next:()=>{this.toastService.showSuccessToast({summary:this.translateService.instant("global.toast.header.success"),detail:this.translateService.instant("areaType.dialog.addSuccess")}),this.onCloseDialog(!0)},error:()=>{this.toastService.showErrorToast({summary:this.translateService.instant("global.toast.header.error"),detail:this.translateService.instant("areaType.dialog.addError")})}})}onCloseDialog(l){this.ref.close(l)}}return c.\u0275fac=function(l){return new(l||c)(t.Y36(d.qu),t.Y36(T.E7),t.Y36(T.S),t.Y36(p.a),t.Y36(b.v),t.Y36(O.k),t.Y36(D.sK))},c.\u0275cmp=t.Xpm({type:c,selectors:[["uwb-area-types-dialog"]],decls:18,vars:15,consts:[[3,"formGroup","ngSubmit","cancel"],["form-body",""],[3,"styleClass"],[1,"p-float-label"],["pInputText","","id","name","formControlName","name","minlength","2","maxlength","50"],["htmlFor","name"],[3,"minLength","maxLength",4,"ngIf"],["pInputText","","id","color","formControlName","color","type","color"],["htmlFor","color"],["formControlName","organizationUnitId",3,"options","label"],[3,"minLength","maxLength"]],template:function(l,a){if(1&l&&(t.TgZ(0,"uwb-form",0),t.NdJ("ngSubmit",function(){return a.onSave()})("cancel",function(){return a.onCloseDialog()}),t.TgZ(1,"uwb-form-grid",1)(2,"uwb-form-control",2)(3,"span",3),t._UZ(4,"input",4),t.TgZ(5,"label",5),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.YNc(8,o,1,2,"uwb-input-warn",6),t.qZA(),t.TgZ(9,"uwb-form-control",2)(10,"span",3),t._UZ(11,"input",7),t.TgZ(12,"label",8),t._uU(13),t.ALo(14,"translate"),t.qZA()()(),t.TgZ(15,"uwb-form-control",2),t._UZ(16,"uwb-tree-select",9),t.ALo(17,"translate"),t.qZA()()()),2&l){let g;t.Q6J("formGroup",a.formGroup),t.xp6(2),t.Q6J("styleClass","col-12"),t.xp6(4),t.Oqu(t.lcZ(7,9,"areaType.name")),t.xp6(2),t.Q6J("ngIf",(null==a.formGroup||null==(g=a.formGroup.get("name"))?null:g.touched)&&(null==a.formGroup||null==(g=a.formGroup.get("name"))?null:g.invalid)),t.xp6(1),t.Q6J("styleClass","col-12"),t.xp6(4),t.Oqu(t.lcZ(14,11,"areaType.color")),t.xp6(2),t.Q6J("styleClass","col-12"),t.xp6(1),t.s9C("label",t.lcZ(17,13,"areaType.organizationUnit")),t.Q6J("options",a.treeSelectItems)}},dependencies:[m.o,y.U,n.A,S.c,C.s,r.z,d.Fj,d.JJ,d.JL,d.wO,d.nD,f.O5,d.sg,d.u,D.X$],encapsulation:2}),c})();var h=i(6641),u=i(5083),E=i(5630),B=i(9185),Z=i(7378),z=i(9496);const J=[{path:"area-types",component:(()=>{class c{constructor(l,a,g,U,M,x,L,P,k){this.authorityService=l,this.clientsService=a,this.areaTypesService=g,this.columnService=U,this.dialogService=M,this.translateService=x,this.toastService=L,this.confirmDialogService=P,this.sizeScreenService=k,this.treeSelectItems=[],this.areaTypes=[],this.columns=[],this.loading=!0}ngOnInit(){this.loading=!0,this.userOrganizationUnitId=this.authorityService.getUserOrganizationUnitId(),this.loadOrganizationUnits(),this.columns=this.columnService.getAreaTypeColumns(),this.loadObjectTypes()}loadOrganizationUnits(){this.clientsService.findTree().subscribe(l=>{this.treeSelectItems=l.body??[],this.treeSelectItemSelected=this.clientsService.findByIdFromUnits(this.treeSelectItems[0],this.userOrganizationUnitId),this.selectedOrganizationUnit=this.treeSelectItemSelected.data})}loadObjectTypes(){this.loading=!0,this.areaTypesService.findAllByOrganizationUnit(this.selectedOrganizationUnit?.id??this.userOrganizationUnitId).subscribe(l=>{this.areaTypes=l.body??[],this.loading=!1})}onOrganizationUnitSelect(l){this.selectedOrganizationUnit?.id!==l.id&&(this.selectedOrganizationUnit=l,this.treeSelectItemSelected=this.clientsService.findByIdFromUnits(this.treeSelectItems[0],this.selectedOrganizationUnit.id),this.selectedAreaType=void 0,this.loadObjectTypes())}openDialog(l=!1){this.dialogService.open(s,{header:this.translateService.instant(l?"global.dialog.editHeader":"global.dialog.addHeader"),data:{edit:l,selectedAreaType:this.selectedAreaType,selectedOrganizationUnit:this.selectedOrganizationUnit},width:this.sizeScreenService.smallScreen?"100%":"40%"}).onClose.subscribe(g=>this.handleDialogResponse(g))}openDeleteDialog(){this.confirmDialogService.openDeleteDialog({},l=>{l&&this.handleDeleteDialog()})}handleDialogResponse(l){l&&(this.selectedAreaType=void 0,this.loadObjectTypes())}handleDeleteDialog(){this.areaTypesService.delete(this.selectedAreaType?.id).subscribe({next:()=>{this.toastService.showSuccessToast({summary:this.translateService.instant("global.toast.header.success"),detail:this.translateService.instant("areaType.dialog.deleteSuccess")}),this.handleDialogResponse(!0)},error:l=>{this.toastService.showErrorToast({summary:this.translateService.instant("global.toast.header.error"),detail:this.translateService.instant("areaType.dialog.deleteError")})}})}}return c.\u0275fac=function(l){return new(l||c)(t.Y36(h.g),t.Y36(p.a),t.Y36(b.v),t.Y36(u.w),t.Y36(T.xA),t.Y36(D.sK),t.Y36(O.k),t.Y36(E.D),t.Y36(B.p))},c.\u0275cmp=t.Xpm({type:c,selectors:[["uwb-area-types"]],decls:6,vars:14,consts:[[1,"single_table_with_buttons"],[3,"columns","values","loading","showHeaderSelect","selection","selectionChange"],[3,"treeSelectValue","options","optionLabel","floatLabel","placeholder","modelChange"],[1,"buttons_container_center"],[3,"styleClass","disabledEditAndDeleteButton","emitAddClick","emitEditClick","emitDeleteClick"]],template:function(l,a){1&l&&(t.TgZ(0,"div",0)(1,"uwb-table",1),t.NdJ("selectionChange",function(U){return a.selectedAreaType=U}),t.TgZ(2,"uwb-tree-select",2),t.NdJ("modelChange",function(U){return a.onOrganizationUnitSelect(U)}),t.ALo(3,"translate"),t.qZA()(),t.TgZ(4,"div",3)(5,"uwb-footer-buttons",4),t.NdJ("emitAddClick",function(){return a.openDialog()})("emitEditClick",function(){return a.openDialog(!0)})("emitDeleteClick",function(){return a.openDeleteDialog()}),t.qZA()()()),2&l&&(t.xp6(1),t.Q6J("columns",a.columns)("values",a.areaTypes)("loading",a.loading)("showHeaderSelect",!0)("selection",a.selectedAreaType),t.xp6(1),t.Q6J("treeSelectValue",a.treeSelectItemSelected)("options",a.treeSelectItems)("optionLabel","name")("floatLabel",!1)("placeholder",t.lcZ(3,12,"background.organizationUnit")),t.xp6(3),t.Q6J("styleClass","col px-2")("disabledEditAndDeleteButton",void 0===a.selectedAreaType))},dependencies:[Z.L,z.EC,C.s,D.X$]}),c})()}];let F=(()=>{class c{}return c.\u0275fac=function(l){return new(l||c)},c.\u0275mod=t.oAB({type:c}),c.\u0275inj=t.cJS({imports:[e.K,_.m,A.Bz.forChild(J)]}),c})()},5630:(I,v,i)=>{i.d(v,{D:()=>d});var e=i(9291),_=i(9972),A=i(3999);let d=(()=>{class t{constructor(p,b){this.confirmationService=p,this.translateService=b,this.confirmDialogOption={key:"mainDeleteConfirmDialog",header:this.translateService.instant("global.dialog.deleteHeader"),message:this.translateService.instant("global.dialog.deleteMessage"),icon:"pi pi-exclamation-triangle"}}openDeleteDialog(p={},b){this.confirmDialogOption={key:p.key??this.confirmDialogOption.key,header:p.header??this.confirmDialogOption.header,message:p.message??this.confirmDialogOption.message,icon:p.icon??this.confirmDialogOption.icon},this.confirmationService.confirm({key:p.key??this.confirmDialogOption.key,header:p.header??this.confirmDialogOption.header,message:p.message??this.confirmDialogOption.message,icon:p.icon??this.confirmDialogOption.icon,accept:()=>{b(!0)},reject:()=>{b(!1)}})}}return t.\u0275fac=function(p){return new(p||t)(e.LFG(_.YP),e.LFG(A.sK))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);