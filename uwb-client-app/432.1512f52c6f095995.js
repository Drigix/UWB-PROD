"use strict";(self.webpackChunkuwb_client_app=self.webpackChunkuwb_client_app||[]).push([[432],{7378:(U,M,l)=>{l.d(M,{L:()=>B});var n=l(9291),A=l(9185),y=l(4089),e=l(6814),f=l(3999);function Z(m,T){if(1&m){const a=n.EpF();n.TgZ(0,"p-button",2),n.NdJ("onClick",function(){n.CHM(a);const S=n.oxw();return n.KtG(S.onAddClick())}),n.ALo(1,"translate"),n.qZA()}if(2&m){const a=n.oxw();n.Tol(a.styleClass),n.Q6J("disabled",a.disabledAddButton)("icon",a.mobileScreen?"pi pi-plus":"")("label",a.mobileScreen?"":n.lcZ(1,6,"global.buttons.add"))("styleClass",a.mobileScreen?a.mobileScreenStyleButtons:a.smallScreen?a.smallScreenStyleButtons:a.normalScreenStyleButtons)}}function _(m,T){if(1&m){const a=n.EpF();n.TgZ(0,"p-button",2),n.NdJ("onClick",function(){n.CHM(a);const S=n.oxw();return n.KtG(S.onEditClick())}),n.ALo(1,"translate"),n.qZA()}if(2&m){const a=n.oxw();n.Tol(a.styleClass),n.Q6J("disabled",a.disabledEditAndDeleteButton)("icon",a.mobileScreen?"pi pi-pencil":"")("label",a.mobileScreen?"":n.lcZ(1,6,"global.buttons.edit"))("styleClass",a.mobileScreen?a.mobileScreenStyleButtons:a.smallScreen?a.smallScreenStyleButtons:a.normalScreenStyleButtons)}}function x(m,T){if(1&m){const a=n.EpF();n.TgZ(0,"p-button",2),n.NdJ("onClick",function(){n.CHM(a);const S=n.oxw();return n.KtG(S.onDeleteClick())}),n.ALo(1,"translate"),n.qZA()}if(2&m){const a=n.oxw();n.Tol(a.styleClass),n.Q6J("disabled",a.disabledEditAndDeleteButton)("icon",a.mobileScreen?"pi pi-trash":"")("label",a.mobileScreen?"":n.lcZ(1,6,"global.buttons.delete"))("styleClass",a.mobileScreen?a.mobileScreenStyleButtons:a.smallScreen?a.smallScreenStyleButtons:a.normalScreenStyleButtons)}}const P=["*"];let B=(()=>{class m{constructor(a){this.sizeScreenService=a,this.showAddButton=!0,this.showEditButton=!0,this.showDeleteButton=!0,this.disabledAddButton=!1,this.disabledEditAndDeleteButton=!1,this.normalScreenStyleButtons="ui-button_size_175",this.smallScreenStyleButtons="ui-button_size_125",this.mobileScreenStyleButtons="ui-button_size_100",this.styleClass="col-4 px-2",this.emitAddClick=new n.vpe,this.emitEditClick=new n.vpe,this.emitDeleteClick=new n.vpe,this.smallScreen=!1,this.mobileScreen=!1}ngOnInit(){this.sizeScreenService.smallScreen$.subscribe(a=>{this.smallScreen=a}),this.sizeScreenService.mobileScreen$.subscribe(a=>{this.mobileScreen=a})}onAddClick(){this.emitAddClick.emit(!0)}onEditClick(){this.emitEditClick.emit(!0)}onDeleteClick(){this.emitDeleteClick.emit(!0)}}return m.\u0275fac=function(a){return new(a||m)(n.Y36(A.p))},m.\u0275cmp=n.Xpm({type:m,selectors:[["uwb-footer-buttons"]],inputs:{showAddButton:"showAddButton",showEditButton:"showEditButton",showDeleteButton:"showDeleteButton",disabledAddButton:"disabledAddButton",disabledEditAndDeleteButton:"disabledEditAndDeleteButton",normalScreenStyleButtons:"normalScreenStyleButtons",smallScreenStyleButtons:"smallScreenStyleButtons",mobileScreenStyleButtons:"mobileScreenStyleButtons",styleClass:"styleClass"},outputs:{emitAddClick:"emitAddClick",emitEditClick:"emitEditClick",emitDeleteClick:"emitDeleteClick"},ngContentSelectors:P,decls:5,vars:3,consts:[[1,"grid"],[3,"class","disabled","icon","label","styleClass","onClick",4,"ngIf"],[3,"disabled","icon","label","styleClass","onClick"]],template:function(a,w){1&a&&(n.F$t(),n.TgZ(0,"div",0),n.YNc(1,Z,2,8,"p-button",1),n.YNc(2,_,2,8,"p-button",1),n.YNc(3,x,2,8,"p-button",1),n.Hsn(4),n.qZA()),2&a&&(n.xp6(1),n.Q6J("ngIf",w.showAddButton),n.xp6(1),n.Q6J("ngIf",w.showEditButton),n.xp6(1),n.Q6J("ngIf",w.showDeleteButton))},dependencies:[y.zx,e.O5,f.X$]}),m})()},7397:(U,M,l)=>{l.d(M,{s:()=>S});var n=l(9291),A=l(6223),y=l(3562),e=l(2420),f=l(9972),Z=l(737),_=l(6814);function x(u,C){if(1&u){const r=n.EpF();n.TgZ(0,"div",5)(1,"div",6)(2,"input",7),n.NdJ("ngModelChange",function(h){n.CHM(r);const g=n.oxw();return n.KtG(g.filterText=h)})("input",function(h){n.CHM(r);const g=n.oxw();return n.KtG(g.customFilter(h))}),n.qZA(),n._UZ(3,"i",8),n.qZA()()}if(2&u){const r=n.oxw();n.xp6(2),n.Q6J("ngModel",r.filterText)}}function P(u,C){if(1&u&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&u){const r=n.oxw().$implicit,c=n.oxw();n.xp6(1),n.hij(" ",null==r?null:r.data[c.optionLabel]," ")}}function B(u,C){if(1&u&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&u){const r=n.oxw(2);n.xp6(1),n.hij(" ",r.placeholder," ")}}function m(u,C){if(1&u&&(n.YNc(0,P,2,1,"span",9),n.YNc(1,B,2,1,"span",9)),2&u){const r=C.$implicit,c=n.oxw();n.Q6J("ngIf",null==r?null:r.data),n.xp6(1),n.Q6J("ngIf",!(null!=r&&r.data||c.floatLabel))}}function T(u,C){if(1&u&&(n.TgZ(0,"span",10),n._uU(1),n.ALo(2,"slice"),n.qZA()),2&u){const r=C.$implicit,c=n.oxw();n.s9C("pTooltip",r.data[c.optionLabel]),n.xp6(1),n.hij(" ",r.data[c.optionLabel].length>30?n.Dn7(2,2,r.data[c.optionLabel],0,30)+"...":r.data[c.optionLabel]," ")}}function a(u,C){if(1&u&&(n.TgZ(0,"label",11),n._uU(1),n.qZA()),2&u){const r=n.oxw();n.xp6(1),n.Oqu(r.label)}}const w=function(){return{width:"100%"}};let S=(()=>{class u{constructor(){this.options=[],this.filter=!0,this.label="Wybierz opcje",this.optionLabel="name",this.styleClass="",this.selectionMode="single",this.floatLabel=!0,this.placeholder="",this.modelChange=new n.vpe,this.itemChange=new n.vpe,this.onModelChange=()=>e.Z,this.onModelTouched=()=>e.Z,this.handleOptions=[],this.filterText=""}ngOnChanges(r){r.options&&(this.handleOptions=this.options)}ngAfterViewInit(){this.treeSelect.registerOnChange(this.onModelChange),this.treeSelect.registerOnTouched(this.onModelTouched)}customFilter(r){const c=this.filterText.toLowerCase();""===c?this.options=this.handleOptions:(this.options=this.handleOptions,this.options=this.filterTree(this.options,c))}filterTree(r,c){const h=[];for(const g of r)if(g?.data&&g.data.name.toLowerCase().includes(c)&&!h.find(D=>D.data.id===g.data.id)&&h.push(g),g.children&&g.children.length>0){const D=this.filterTree(g.children,c);if(D.length>0&&!h.find(v=>v.data.id===g.data.id)){const v={...g};v.children=D,h.push(v)}}return h}writeValue(r){this.treeSelectValue=r}registerOnChange(r){this.onModelChange=r}registerOnTouched(r){this.onModelTouched=r}emitModelAndItemChange(r){this.modelChange.emit(r.node.data),this.emitItemChange({value:r.node.data})}emitItemChange(r){const c=r.value?this.options.find(h=>h?.[this.itemValue]===r.value):void 0;this.itemChange.emit(Object.assign({},r,{item:c??null}))}}return u.\u0275fac=function(r){return new(r||u)},u.\u0275cmp=n.Xpm({type:u,selectors:[["uwb-tree-select"]],viewQuery:function(r,c){if(1&r&&n.Gf(y.mP,7),2&r){let h;n.iGM(h=n.CRH())&&(c.treeSelect=h.first)}},inputs:{options:"options",filter:"filter",label:"label",optionLabel:"optionLabel",treeSelectValue:"treeSelectValue",itemValue:"itemValue",styleClass:"styleClass",selectionMode:"selectionMode",floatLabel:"floatLabel",placeholder:"placeholder"},outputs:{modelChange:"modelChange",itemChange:"itemChange"},features:[n._Bn([{provide:A.JU,useExisting:(0,n.Gpc)(()=>u),multi:!0}]),n.TTD],decls:6,vars:12,consts:[["placeholder","","appendTo","body",3,"ngModel","options","placeholder","selectionMode","ngModelChange","onNodeSelect"],["pTemplate","header"],["pTemplate","value"],["pTemplate","default"],["for","label",4,"ngIf"],[1,"p-treeselect-header"],[1,"p-treeselect-filter-container","p-input-icon-right","custom-filter"],["type","text","autofocus","","placeholder","Filter",1,"p-treeselect-filter","p-inputtext","p-component",3,"ngModel","ngModelChange","input"],[1,"pi","pi-search"],[4,"ngIf"],[3,"pTooltip"],["for","label"]],template:function(r,c){1&r&&(n.TgZ(0,"span")(1,"p-treeSelect",0),n.NdJ("ngModelChange",function(g){return c.treeSelectValue=g})("onNodeSelect",function(g){return c.emitModelAndItemChange(g)}),n.YNc(2,x,4,1,"ng-template",1),n.YNc(3,m,2,2,"ng-template",2),n.YNc(4,T,3,6,"ng-template",3),n.qZA(),n.YNc(5,a,2,1,"label",4),n.qZA()),2&r&&(n.Tol(c.floatLabel?"p-float-label":""),n.xp6(1),n.Akn(n.DdM(11,w)),n.Tol(c.styleClass),n.Q6J("ngModel",c.treeSelectValue)("options",c.options)("placeholder",c.placeholder)("selectionMode",c.selectionMode),n.xp6(4),n.Q6J("ngIf",c.floatLabel))},dependencies:[f.jx,Z.u,y.mP,A.Fj,A.JJ,A.On,_.O5,_.OU],styles:[".p-inputtext.ng-valid[_ngcontent-%COMP%]{border-left:none;border:1px solid #ced4da}  .p-treeselect .p-treeselect-label span{color:#000}  .p-treeselect-items-wrapper::-webkit-scrollbar{width:12px}  .p-treeselect-items-wrapper::-webkit-scrollbar-thumb{border-radius:.5rem;background:var(--uwb-menu-scrollbar-thumb)}  .p-treeselect-items-wrapper::-webkit-scrollbar-thumb:hover{background:var(--uwb-menu-scrollbar-thumb-hover)}  .p-treeselect-items-wrapper::-webkit-scrollbar-track{background:var(--uwb-menu-scrollbar-track);background-color:transparent}"]}),u})()},2432:(U,M,l)=>{l.r(M),l.d(M,{AnchorsModule:()=>ae});var n=l(6106),A=l(6208),y=l(2125),e=l(9291),f=l(8892),Z=l(9222),_=l(5630),x=l(6641),P=l(1407),B=l(7966),m=l(3999),T=l(1321),a=l(9185),w=l(9972),S=l(737),u=l(7378),C=l(641),r=l(4112),c=l(1095),h=l(5311),g=l(3703),D=l(4089),v=l(6814),E=l(9061);function O(i,d){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"div",5),e.qZA()),2&i){const t=e.oxw();e.Tol(t.styleClass)}}function I(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"p-button",11),e.NdJ("onClick",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.onDrawClick())}),e.ALo(1,"translate"),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("disabled",t.disabledMapButtons)("icon",t.mobileScreen?"pi pi-palette":"")("styleClass",t.mobileScreen?"ui-button_size_100":"ui-button_size_125")("label",t.mobileScreen?"":e.lcZ(1,4,"global.buttons.draw"))}}function N(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"p-button",11),e.NdJ("onClick",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.onModifyClick())}),e.ALo(1,"translate"),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("disabled",t.disabledMapButtons)("icon",t.mobileScreen?"pi pi-pencil":"")("styleClass",t.mobileScreen?"ui-button_size_100":"ui-button_size_125")("label",t.mobileScreen?"":e.lcZ(1,4,"global.buttons.edit"))}}function L(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,I,2,6,"p-button",10),e.YNc(2,N,2,6,"p-button",10),e.TgZ(3,"p-button",11),e.NdJ("onClick",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.deleteVertex())}),e.ALo(4,"translate"),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",0===t.vertexes.length),e.xp6(1),e.Q6J("ngIf",t.vertexes.length>0),e.xp6(1),e.Q6J("disabled",t.disabledMapButtons)("icon",t.mobileScreen?"pi pi-trash":"")("styleClass",t.mobileScreen?"ui-button_size_100":"ui-button_size_125")("label",t.mobileScreen?"":e.lcZ(4,6,"global.buttons.clear"))}}function J(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"p-button",12),e.NdJ("onClick",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.saveVertex())}),e.ALo(1,"translate"),e.qZA(),e.TgZ(2,"p-button",13),e.NdJ("onClick",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.loadVertexes())}),e.ALo(3,"translate"),e.qZA()}if(2&i){const t=e.oxw(2);e.s9C("label",e.lcZ(1,3,"global.buttons.save")),e.Q6J("disabled",t.disabledMapButtons),e.xp6(2),e.s9C("label",e.lcZ(3,5,"global.buttons.cancel"))}}function z(i,d){if(1&i&&(e.TgZ(0,"div",6),e._UZ(1,"div",5),e.TgZ(2,"div",7),e.YNc(3,L,5,8,"div",8),e.YNc(4,J,4,7,"ng-template",null,9,e.W1O),e.qZA()()),2&i){const t=e.MAs(5),o=e.oxw();e.xp6(3),e.Q6J("ngIf",!1===o.modified&&!1===o.drawable)("ngIfElse",t)}}function F(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"uwb-map-panel",15),e.NdJ("emitPreviousClick",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.goToPreviousPoint())})("emitNextClick",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.goToNextPoint())})("emitPlayClick",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.goToNextPointAutomatic())})("emitPauseClick",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.stopGoToNextPointAutomatic())})("emitTimeToChangePoint",function(s){e.CHM(t);const p=e.oxw(2);return e.KtG(p.onTimeToChangePointChenge(s))}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("disabledButtons",t.disabledMapPanelButtons)}}function Q(i,d){if(1&i&&(e.TgZ(0,"div")(1,"div",5),e.YNc(2,F,1,1,"uwb-map-panel",14),e.qZA()()),2&i){const t=e.oxw();e.Tol(t.styleClass),e.xp6(2),e.Q6J("ngIf",t.background&&""!==t.background)}}function G(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"p-button",20),e.NdJ("onClick",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.emitEditSelectedPoint.emit(s.selectedMapPoint))}),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"p-button",21),e.NdJ("onClick",function(){e.CHM(t);const s=e.oxw(3);return e.KtG(s.emitDeleteSelectedPoint.emit(s.selectedMapPoint))}),e.ALo(4,"translate"),e.qZA()()}2&i&&(e.xp6(1),e.s9C("pTooltip",e.lcZ(2,2,"global.buttons.edit")),e.xp6(2),e.s9C("pTooltip",e.lcZ(4,4,"global.buttons.delete")))}function Y(i,d){if(1&i&&(e.TgZ(0,"div",17)(1,"span",18),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",18),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"span",18),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"span",18),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.YNc(13,G,5,6,"div",19),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.AsE(" ",e.lcZ(3,9,"anchor.name"),": ",t.selectedMapPoint.name," "),e.xp6(3),e.AsE(" ",e.lcZ(6,11,"anchor.x"),": ",t.selectedMapPoint.x," "),e.xp6(3),e.AsE(" ",e.lcZ(9,13,"anchor.y"),": ",t.selectedMapPoint.y," "),e.xp6(3),e.AsE(" ",e.lcZ(12,15,"anchor.z"),": ",t.selectedMapPoint.z," "),e.xp6(2),e.Q6J("ngIf",t.showAnchorOverlayButtons)}}function K(i,d){if(1&i&&(e.ynx(0),e.YNc(1,Y,14,17,"div",16),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.selectedMapPoint&&t.showOverlay)}}function H(i,d){if(1&i&&(e.TgZ(0,"div",17)(1,"span",18),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",18),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"span",18),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"span",18),e._uU(11),e.ALo(12,"translate"),e.ALo(13,"date"),e.qZA()()),2&i){const t=e.oxw(2);e.xp6(2),e.AsE(" ",e.lcZ(3,8,"localization.tag.name"),": ",t.selectedMapPoint.name," "),e.xp6(3),e.AsE(" ",e.lcZ(6,10,"localization.tag.x"),": ",t.selectedMapPoint.x," "),e.xp6(3),e.AsE(" ",e.lcZ(9,12,"localization.tag.y"),": ",t.selectedMapPoint.y," "),e.xp6(3),e.AsE(" ",e.lcZ(12,14,"localization.tag.date"),": ",e.xi3(13,16,t.selectedMapPoint.date,"yyyy-M-dd, HH:mm:ss")," ")}}function R(i,d){if(1&i&&(e.ynx(0),e.YNc(1,H,14,19,"div",16),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.selectedMapPoint)}}let W=(()=>{class i extends r.G{constructor(t,o){super(t,o),this.cd=t,this.renderer=o}ngOnInit(){this.overlayType=g.L.ANCHOR,this.showAnchorOverlayButtons=!0}ngOnChanges(t){if(t.background&&""!==this.background&&this.loadMap(),(t.anchors||t.mapClickMode)&&(this.loadPoints(c.Q),this.loadOnMapClickOptions(c.Q)),t.selectedMapPoint&&this.selectedMapPoint){const s=this.source.getFeatureById("anchor_"+this.selectedMapPoint.id)?.getGeometry();if(s instanceof h.Z){const k=s.getCoordinates();this.overlay.setPosition(k),this.cd.detectChanges()}}}loadPoints(t){if(this.overlay.setPosition(void 0),this.source.clear(),"else"===this.mapClickMode)this.showOverlay=!0,this.selectedMapPoint=void 0,this.anchors.forEach(o=>{let s="anchor_NEW";null!==o.id&&(s="anchor_"+o.id),this.addPointToMap([o.xPx,o.yPx],s,t),this.source.changed()});else if("edit"===this.mapClickMode){this.showOverlay=!1;const o=this.selectedMapPoint;this.addPointToMap([o.xPx,o.yPx],"anchor_"+o.id,t)}}loadOnMapClickOptions(t){this.map.on("click",o=>{if("add"===this.mapClickMode){const s=this.source.getFeatureById("anchor_NEW"),p=this.map.getCoordinateFromPixel(o.pixel);s?s.setGeometry(new h.Z(p)):this.addPointToMap(p,"anchor_NEW",t),this.source.changed(),this.selectedMapPoint={x:p[0],y:p[1]},this.emitNewPoint.emit(this.selectedMapPoint)}else if("edit"===this.mapClickMode){const s=this.map.getCoordinateFromPixel(o.pixel);this.source.getFeatureById("anchor_"+this.selectedMapPoint.id)?.setGeometry(new h.Z(s)),this.selectedMapPoint={...this.selectedMapPoint,x:s[0],y:s[1]},this.source.changed(),this.emitNewPoint.emit(this.selectedMapPoint)}else if(this.map.getFeaturesAtPixel(o.pixel).length>0){const s=this.map.getFeaturesAtPixel(o.pixel)[0].getId();s.startsWith("anchor_")?(this.selectedMapPoint=this.anchors.find(p=>p.id===parseInt(s.split("_")[1],10)),this.overlay.setPosition(o.coordinate),this.cd.detectChanges()):this.overlay.setPosition(void 0)}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.sBO),e.Y36(e.Qsj))},i.\u0275cmp=e.Xpm({type:i,selectors:[["uwb-map-anchors"]],features:[e.qOj,e.TTD],decls:8,vars:7,consts:[[3,"ngSwitch"],[3,"class",4,"ngSwitchCase"],["class","single_map_with_footer",4,"ngSwitchCase"],["id","popup",1,"overlay"],[4,"ngSwitchCase"],["id","map",1,"map"],[1,"single_map_with_footer"],[1,"buttons_container_center"],[4,"ngIf","ngIfElse"],["saveTemplate",""],["class","px-2",3,"disabled","icon","styleClass","label","onClick",4,"ngIf"],[1,"px-2",3,"disabled","icon","styleClass","label","onClick"],["styleClass","ui-button_size_125",1,"px-2",3,"disabled","label","onClick"],["styleClass","ui-button_size_125","type","button","data-dismiss","modal",3,"label","onClick"],[3,"disabledButtons","emitPreviousClick","emitNextClick","emitPlayClick","emitPauseClick","emitTimeToChangePoint",4,"ngIf"],[3,"disabledButtons","emitPreviousClick","emitNextClick","emitPlayClick","emitPauseClick","emitTimeToChangePoint"],["class","flex flex-column",4,"ngIf"],[1,"flex","flex-column"],[1,"p-1"],["class","buttons_container_center",4,"ngIf"],["styleClass","ui-button_size_125","icon","pi pi-pencil",1,"p-2",3,"pTooltip","onClick"],["styleClass","ui-button_size_125","icon","pi pi-times",1,"p-2",3,"pTooltip","onClick"]],template:function(t,o){1&t&&(e.ynx(0,0),e.YNc(1,O,2,2,"div",1),e.YNc(2,z,6,2,"div",2),e.YNc(3,Q,3,3,"div",1),e.BQk(),e.TgZ(4,"div",3),e.ynx(5,0),e.YNc(6,K,2,1,"ng-container",4),e.YNc(7,R,2,1,"ng-container",4),e.BQk(),e.qZA()),2&t&&(e.Q6J("ngSwitch",o.mapDisplayType),e.xp6(1),e.Q6J("ngSwitchCase","normal"),e.xp6(1),e.Q6J("ngSwitchCase","mapWithButtons"),e.xp6(1),e.Q6J("ngSwitchCase","mapWithBodyInside"),e.xp6(2),e.Q6J("ngSwitch",o.overlayType),e.xp6(1),e.Q6J("ngSwitchCase","anchor"),e.xp6(1),e.Q6J("ngSwitchCase","tag"))},dependencies:[S.u,D.zx,v.O5,v.RF,v.n9,E.Z,v.uU,m.X$],styles:[".map[_ngcontent-%COMP%]{width:100%;height:100%;border:2px solid var(--uwb-primary);border-radius:15px}  .ol-control{display:flex}  .ol-control button{background-color:var(--uwb-button-background);color:var(--uwb-button-text-color);height:30px;width:30px;border-radius:15px}.overlay[_ngcontent-%COMP%]{background:var(--uwb-background);color:var(--uwb-internal-tab-font-color);border:0 none;border-radius:var(--border-radius);box-shadow:0 1px 3px #0000004d;padding:10px;position:absolute}.overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;text-wrap:nowrap}  .ol-zoom{right:.5rem;left:auto}"]}),i})();var V=l(7397),b=l(6223),j=l(5969),q=l(7477),$=l(2435),X=l(7571),ee=l(6861);function te(i,d){1&i&&e._UZ(0,"uwb-input-warn",13),2&i&&e.Q6J("minLength",2)("maxLength",30)}let ne=(()=>{class i{constructor(t,o,s,p){this.formBuilder=t,this.anchorsService=o,this.toastService=s,this.translateService=p,this.edit=!1,this.emitCloseDialog=new e.vpe}ngOnInit(){this.loadFormGroup()}ngOnChanges(t){t.selectedAnchor&&this.formGroup?.patchValue({name:this.selectedAnchor?.name??this.handleAnchorName,x:this.selectedAnchor?.x,y:this.selectedAnchor?.y,z:this.selectedAnchor?.z??this.handleAnchorZ,backgroundId:this.selectedBackgroundId})}loadFormGroup(){this.formGroup=this.formBuilder.group({name:[{value:null,disabled:!1},[b.kI.required,b.kI.minLength(2),b.kI.maxLength(30)]],x:[{value:null,disabled:!1},[b.kI.required]],y:[{value:null,disabled:!1},[b.kI.required]],z:[{value:null,disabled:!1},[b.kI.required]],backgroundId:[{value:null,disabled:!1},[b.kI.required]]}),this.edit&&this.formGroup.patchValue({name:this.selectedAnchor?.name,x:this.selectedAnchor?.x,y:this.selectedAnchor?.y,z:this.selectedAnchor?.z,backgroundId:this.selectedAnchor?.backgroundId})}onNameInputChange(){this.handleAnchorName=this.formGroup?.get("name")?.getRawValue()}onZInputChange(){this.handleAnchorZ=this.formGroup?.get("z")?.getRawValue()}onSave(){const t=this.formGroup?.getRawValue();this.edit?(t.id=this.selectedAnchor?.id,this.anchorsService.update(t).subscribe({next:()=>{this.toastService.showSuccessToast({summary:this.translateService.instant("global.toast.header.success"),detail:this.translateService.instant("anchor.dialog.editSuccess")}),this.emitCloseDialog.emit(!0)},error:()=>{this.toastService.showErrorToast({summary:this.translateService.instant("global.toast.header.error"),detail:this.translateService.instant("anchor.dialog.editError")})}})):this.anchorsService.create(t).subscribe({next:()=>{this.toastService.showSuccessToast({summary:this.translateService.instant("global.toast.header.success"),detail:this.translateService.instant("anchor.dialog.addSuccess")}),this.emitCloseDialog.emit(!0)},error:o=>{this.toastService.showErrorToast(409===o.status?{summary:this.translateService.instant("global.toast.header.error"),detail:this.translateService.instant("anchor.dialog.idAlreadyExistsError")}:{summary:this.translateService.instant("global.toast.header.error"),detail:this.translateService.instant("anchor.dialog.addError")})}})}onCloseDialog(){this.emitCloseDialog.emit(!1)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(b.qu),e.Y36(Z.C),e.Y36(B.k),e.Y36(m.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["uwb-anchors-dialog"]],inputs:{edit:"edit",selectedAnchor:"selectedAnchor",selectedBackgroundId:"selectedBackgroundId"},outputs:{emitCloseDialog:"emitCloseDialog"},features:[e.TTD],decls:27,vars:19,consts:[[3,"formGroup","footerButton","ngSubmit","cancel"],["form-body",""],[3,"styleClass"],[1,"p-float-label"],["pInputText","","id","name","formControlName","name","minlength","2","maxlength","30",3,"input"],["htmlFor","name"],[3,"minLength","maxLength",4,"ngIf"],["pInputText","","id","x","formControlName","x"],["htmlFor","x"],["pInputText","","id","y","formControlName","y"],["htmlFor","y"],["pInputText","","id","z","formControlName","z",3,"input"],["htmlFor","z"],[3,"minLength","maxLength"]],template:function(t,o){if(1&t&&(e.TgZ(0,"uwb-form",0),e.NdJ("ngSubmit",function(){return o.onSave()})("cancel",function(){return o.onCloseDialog()}),e.TgZ(1,"uwb-form-grid",1)(2,"uwb-form-control",2)(3,"span",3)(4,"input",4),e.NdJ("input",function(){return o.onNameInputChange()}),e.qZA(),e.TgZ(5,"label",5),e._uU(6),e.ALo(7,"translate"),e.qZA()(),e.YNc(8,te,1,2,"uwb-input-warn",6),e.qZA(),e.TgZ(9,"uwb-form-control",2)(10,"span",3),e._UZ(11,"input",7),e.TgZ(12,"label",8),e._uU(13),e.ALo(14,"translate"),e.qZA()()(),e.TgZ(15,"uwb-form-control",2)(16,"span",3),e._UZ(17,"input",9),e.TgZ(18,"label",10),e._uU(19),e.ALo(20,"translate"),e.qZA()()(),e.TgZ(21,"uwb-form-control",2)(22,"span",3)(23,"input",11),e.NdJ("input",function(){return o.onZInputChange()}),e.qZA(),e.TgZ(24,"label",12),e._uU(25),e.ALo(26,"translate"),e.qZA()()()()()),2&t){let s;e.Q6J("formGroup",o.formGroup)("footerButton",!1),e.xp6(2),e.Q6J("styleClass","col-12"),e.xp6(4),e.Oqu(e.lcZ(7,11,"anchor.name")),e.xp6(2),e.Q6J("ngIf",(null==o.formGroup||null==(s=o.formGroup.get("name"))?null:s.touched)&&(null==o.formGroup||null==(s=o.formGroup.get("name"))?null:s.invalid)),e.xp6(1),e.Q6J("styleClass","col-12"),e.xp6(4),e.Oqu(e.lcZ(14,13,"anchor.x")),e.xp6(2),e.Q6J("styleClass","col-12"),e.xp6(4),e.Oqu(e.lcZ(20,15,"anchor.y")),e.xp6(2),e.Q6J("styleClass","col-12"),e.xp6(4),e.Oqu(e.lcZ(26,17,"anchor.z"))}},dependencies:[j.o,q.U,$.A,X.c,ee.z,b.Fj,b.JJ,b.JL,b.wO,b.nD,v.O5,b.sg,b.u,m.X$],encapsulation:2}),i})();function oe(i,d){if(1&i&&(e.TgZ(0,"div",10),e._UZ(1,"img",11),e._uU(2),e.qZA()),2&i){const t=d.item;e.s9C("pTooltip",t.name),e.xp6(1),e.Q6J("src",t.path,e.LSH),e.xp6(1),e.hij(" ",t.name," ")}}function ie(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"uwb-anchors-dialog",12),e.NdJ("emitCloseDialog",function(s){e.CHM(t);const p=e.oxw();return e.KtG(p.handleDialogResponse(s))}),e.qZA()}if(2&i){const t=e.oxw();e.Tol(t.smallScreen?"col-12":"col-4"),e.Q6J("edit",t.isEditDialog)("selectedAnchor",t.selectedAnchor)("selectedBackgroundId",null==t.selectedBackground?null:t.selectedBackground.id)}}function se(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"uwb-footer-buttons",14),e.NdJ("emitAddClick",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.openDialog())}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("disabledAddButton",void 0===t.selectedBackground)("showEditButton",!1)("showDeleteButton",!1)}}const le=[{path:"anchors",component:(()=>{class i{constructor(t,o,s,p,k,re,ce,de,pe){this.backgroundsService=t,this.anchorsService=o,this.confirmDialogService=s,this.authorityService=p,this.arrayBufferService=k,this.toastService=re,this.translateService=ce,this.clientsService=de,this.sizeScreenService=pe,this.treeSelectItems=[],this.backgrounds=[],this.anchors=[],this.isDialogOpen=!1,this.isEditDialog=!1,this.smallScreen=!1,this.mapClickMode="else"}ngOnInit(){this.sizeScreenService.smallScreen$.subscribe(t=>{this.smallScreen=t}),this.userOrganizationUnitId=this.authorityService.getUserOrganizationUnitId(),this.loadOrganizationUnits(),this.loadBackgrounds()}loadOrganizationUnits(){this.clientsService.findTree().subscribe(t=>{this.treeSelectItems=t.body??[],this.treeSelectItemSelected=this.clientsService.findByIdFromUnits(this.treeSelectItems[0],this.userOrganizationUnitId),this.selectedOrganizationUnit=this.treeSelectItemSelected.data})}loadBackgrounds(){this.backgroundsService.findAllByUserOrganizationUnit(this.selectedOrganizationUnit?.id??this.userOrganizationUnitId).subscribe(t=>{this.backgrounds=t.body??[],this.backgrounds.forEach(o=>o.fullPath=this.arrayBufferService.convertImage(o.pathArrayBuffer))})}loadAnchors(t){this.anchorsService.findAllByBackground(t).subscribe(o=>{this.anchors=o.body??[]})}onOrganizationUnitSelect(t){this.selectedOrganizationUnit?.id!==t.id&&(this.selectedOrganizationUnit=t,this.treeSelectItemSelected=this.clientsService.findByIdFromUnits(this.treeSelectItems[0],this.selectedOrganizationUnit.id),this.selectedBackground=void 0,this.selectedAnchor=void 0,this.loadBackgrounds())}onBackgroundSelect(t){this.selectedBackground=t,this.loadAnchors(this.selectedBackground.id)}onAnchorSelect(t){this.selectedAnchor=t,this.selectedAnchor||(this.isDialogOpen=!1,this.mapClickMode="else")}onAddNewPoint(t){t.x/=this.selectedBackground?.scale,t.y/=this.selectedBackground?.scale,this.selectedAnchor=t}openDialog(t=!1,o){this.isEditDialog=t,this.mapClickMode=this.isEditDialog?"edit":"add",this.selectedAnchor=o,this.isDialogOpen=!0}openDeleteDialog(t){this.confirmDialogService.openDeleteDialog({},o=>{o&&this.handleDeleteDialog(t?.id)})}handleDialogResponse(t){this.mapClickMode="else",this.isDialogOpen=!1,t&&(this.selectedAnchor=void 0,this.anchors=[],this.loadAnchors(this.selectedBackground?.id))}handleDeleteDialog(t){this.anchorsService.delete(t).subscribe({next:()=>{this.toastService.showSuccessToast({summary:this.translateService.instant("global.toast.header.success"),detail:this.translateService.instant("anchor.dialog.deleteSuccess")}),this.handleDialogResponse(!0)},error:o=>{this.toastService.showErrorToast({summary:this.translateService.instant("global.toast.header.error"),detail:this.translateService.instant("anchor.dialog.deleteError")})}})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.s),e.Y36(Z.C),e.Y36(_.D),e.Y36(x.g),e.Y36(P.A),e.Y36(B.k),e.Y36(m.sK),e.Y36(T.a),e.Y36(a.p))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-anchors"]],decls:14,vars:36,consts:[[1,"anchors"],[1,"grid"],[3,"treeSelectValue","options","optionLabel","label","modelChange"],["optionLabel","name",3,"items","label","itemTemplate","modelChange"],["pTemplate","item"],["itemTemplate",""],["optionLabel","name",3,"value","showClear","isDisabled","items","label","modelChange"],[3,"background","anchors","selectedMapPoint","mapClickMode","emitNewPoint","emitEditSelectedPoint","emitDeleteSelectedPoint"],[3,"class","edit","selectedAnchor","selectedBackgroundId","emitCloseDialog",4,"ngIf"],["class","buttons_container_center buttons_container_scale",4,"ngIf"],[1,"flex","align-items-center",3,"pTooltip"],[2,"height","30px",3,"src"],[3,"edit","selectedAnchor","selectedBackgroundId","emitCloseDialog"],[1,"buttons_container_center","buttons_container_scale"],[3,"disabledAddButton","showEditButton","showDeleteButton","emitAddClick"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"uwb-tree-select",2),e.NdJ("modelChange",function(p){return o.onOrganizationUnitSelect(p)}),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"uwb-single-select",3),e.NdJ("modelChange",function(p){return o.onBackgroundSelect(p)}),e.ALo(5,"translate"),e.YNc(6,oe,3,3,"ng-template",4,5,e.W1O),e.qZA(),e.TgZ(8,"uwb-single-select",6),e.NdJ("modelChange",function(p){return o.onAnchorSelect(p)}),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"div",1)(11,"uwb-map-anchors",7),e.NdJ("emitNewPoint",function(p){return o.onAddNewPoint(p)})("emitEditSelectedPoint",function(p){return o.openDialog(!0,p)})("emitDeleteSelectedPoint",function(p){return o.openDeleteDialog(p)}),e.qZA(),e.YNc(12,ie,1,5,"uwb-anchors-dialog",8),e.qZA(),e.YNc(13,se,2,3,"div",9),e.qZA()),2&t){const s=e.MAs(7);e.Tol(o.isDialogOpen?o.smallScreen?"single_map_with_navbar_small_screen":"single_map_with_navbar":o.smallScreen?"single_map_with_navbar_and_footer_small_screen":"single_map_with_navbar_and_footer"),e.xp6(2),e.Tol(o.smallScreen?"col-12":"col-4"),e.Q6J("treeSelectValue",o.treeSelectItemSelected)("options",o.treeSelectItems)("optionLabel","name")("label",e.lcZ(3,30,"background.organizationUnit")),e.xp6(2),e.Tol(o.smallScreen?"col-12":"col-4"),e.s9C("label",e.lcZ(5,32,"anchor.backgrounds")),e.Q6J("items",o.backgrounds)("itemTemplate",s),e.xp6(4),e.Tol(o.smallScreen?"col-12":"col-4"),e.s9C("label",e.lcZ(9,34,"anchor.anchors")),e.Q6J("value",o.selectedAnchor)("showClear",!1)("isDisabled","add"===o.mapClickMode)("items",o.anchors),e.xp6(2),e.Tol(o.smallScreen?"flex-row":"flex-row-reverse"),e.xp6(1),e.Tol(o.isDialogOpen?o.smallScreen?"col-12":"col-8":"col-12"),e.Q6J("background",null==o.selectedBackground?null:o.selectedBackground.fullPath)("anchors",o.anchors)("selectedMapPoint",o.selectedAnchor)("mapClickMode",o.mapClickMode),e.xp6(1),e.Q6J("ngIf",o.isDialogOpen),e.xp6(1),e.Q6J("ngIf",!o.isDialogOpen)}},dependencies:[w.jx,S.u,u.L,C.g,W,V.s,v.O5,ne,m.X$]}),i})()}];let ae=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[n.K,A.m,y.Bz.forChild(le)]}),i})()},5630:(U,M,l)=>{l.d(M,{D:()=>e});var n=l(9291),A=l(9972),y=l(3999);let e=(()=>{class f{constructor(_,x){this.confirmationService=_,this.translateService=x,this.confirmDialogOption={key:"mainDeleteConfirmDialog",header:this.translateService.instant("global.dialog.deleteHeader"),message:this.translateService.instant("global.dialog.deleteMessage"),icon:"pi pi-exclamation-triangle"}}openDeleteDialog(_={},x){this.confirmDialogOption={key:_.key??this.confirmDialogOption.key,header:_.header??this.confirmDialogOption.header,message:_.message??this.confirmDialogOption.message,icon:_.icon??this.confirmDialogOption.icon},this.confirmationService.confirm({key:_.key??this.confirmDialogOption.key,header:_.header??this.confirmDialogOption.header,message:_.message??this.confirmDialogOption.message,icon:_.icon??this.confirmDialogOption.icon,accept:()=>{x(!0)},reject:()=>{x(!1)}})}}return f.\u0275fac=function(_){return new(_||f)(n.LFG(A.YP),n.LFG(y.sK))},f.\u0275prov=n.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()}}]);